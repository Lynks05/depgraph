/*! depgraph 16-09-2013 */
!function(a){a.DepGraph=function(a,b,c){this.init(a,b,c)},a.GraphViewer=function(a,b){this.init(a,b)},a.EditObject=function(a){this.init(a)},a.Box=function(a){this.init(a)}}(window.depgraphlib=window.depgraphlib||{}),function(a){a.setAttrPath=function(b,c,d){for(var e=c.split("/"),f=b,g=0;g<e.length-1;g++){var h=f[e[g]];h||(f[e[g]]={},h=f[e[g]]),f=h}var i=a.clone(f[e[e.length-1]]);return f[e[e.length-1]]=d,i},a.getDOMRawId=function(a){var b=a;return 0==a.indexOf("#")&&(a.length>1?b=a.substring(1):(b="",console.log("warning : returning empty id ( in func: depgraphlib.getDOMRawId)"))),b},a.jQuerizeID=function(a){return 0==a.indexOf("#")?a:"#"+a},a.windowOpenPost=function(b,c){a.windowOpenPostForm='<form id="depgraphlibWindowOpenPostForm" method="post" action="'+c+'" target="_blank"></form>';var d=jQuery("#depgraphlibWindowOpenPostForm");d.length||(d=jQuery(a.windowOpenPostForm),jQuery("body").append(d)),d.html("");for(param in b){var e=null;e="string"==typeof b[param]?b[param]:JSON.stringify(b[param]),d.append('<input type="hidden" name="'+param+'" value="">'),d[0][param].value=e}document.getElementById("depgraphlibWindowOpenPostForm").submit()},a.clone=function(b){if(null==b||"object"!=typeof b)return b;if(b instanceof Date){var c=new Date;return c.setTime(b.getTime()),c}if(b instanceof Array){for(var c=[],d=0,e=b.length;e>d;d++)c[d]=a.clone(b[d]);return c}if(b instanceof Object){var c={};for(var f in b)b.hasOwnProperty(f)&&(c[f]=a.clone(b[f]));return c}throw new Error("Unable to copy obj! Its type isn't supported.")},a.setGroupPosition=function(a,b,c){a.attr("transform","translate("+b+","+c+")")},a.center=function(a,b){var c=b.node().getBBox(),d=a.node().getBBox();a.attr("x",-d.width/2+c.width/2)},a.getTransformValues=function(a){for(var b,c=a.attr("transform"),d=/(\w+)\((.*?)\)/g,e=new Object;null!=(b=d.exec(c));){var f=/(-*\w+\.*\w*)/g;e[b[1]]=[];for(var g;null!=(g=f.exec(b[2]));)e[b[1]].push(parseFloat(g[1]))}return e},a.JSONresolveReferences=function(a,b){function c(a,b,d,e){for(var f in a)if(a.hasOwnProperty(f))if("id"!=f){var g=typeof a[f];if("object"==g)c(a[f],b,d,e);else if("string"==g&&0==a[f].indexOf(b)){var h=a[f].substring(1);null!=d[h]?(a[f]=d[h],c(a[f],b,d,e)):e.push[a[f]]}}else d[a[f]]=a}var d=[],e=[];c(a,b,d,e);for(elt in e){if(null==d[elt])throw"This object has missing references!";elt=d[elt]}},a.removeUnit=function(a){var b=/(-*)(\d+\.*\d*)px/,c=b.exec(a);if(null!=c){var d=0==c[1].length%2?"":"-";a=d+c[2]}return parseFloat(a)},a.addPxs=function(){for(var b=0,c=0;c<arguments.length;c++){var d=a.removeUnit(arguments[c]);b+=parseInt(d)}return b+"px"},a.rgbToHex=function(a,b,c){return"#"+((1<<24)+(a<<16)+(b<<8)+c).toString(16).slice(1)},a.hexToRgb=function(a){var b=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(a);return b?{r:parseInt(b[1],16),g:parseInt(b[2],16),b:parseInt(b[3],16)}:null},a.rgbToHsl=function(a,b,c){a/=255,b/=255,c/=255;var d,e,f=Math.max(a,b,c),g=Math.min(a,b,c),h=(f+g)/2;if(f==g)d=e=0;else{var i=f-g;switch(e=h>.5?i/(2-f-g):i/(f+g),f){case a:d=(b-c)/i+(c>b?6:0);break;case b:d=(c-a)/i+2;break;case c:d=(a-b)/i+4}d/=6}return{h:d,s:e,l:h}},a.hslToRgb=function(a,b,c){function d(a,b,c){return 0>c&&(c+=1),c>1&&(c-=1),1/6>c?a+6*(b-a)*c:.5>c?b:2/3>c?a+6*(b-a)*(2/3-c):a}var e,f,g;if(0==b)e=f=g=c;else{var h=.5>c?c*(1+b):c+b-c*b,i=2*c-h;e=d(i,h,a+1/3),f=d(i,h,a),g=d(i,h,a-1/3)}return{r:Math.floor(255*e),g:Math.floor(255*f),b:Math.floor(255*g)}}}(window.depgraphlib=window.depgraphlib||{}),function(a){a.GraphViewer.prototype.createBox=function(b){return b.viewer=this,new a.Box(b)},a.Box.prototype.init=function(b){var c=this;if(c.options=b,null!=b.viewer&&(a.Box.instances.push(this),this.viewer=b.viewer),this.object=jQuery('<div class="depgraphlib-box"><div class="depgraphlib-box-header"></div><div class="depgraphlib-box-content"></div><div class="depgraphlib-box-footer"></div></div>'),b.id&&this.object.attr("id",b.id),b.closeButton){var d=jQuery('<div class="tooltip-exit-button"/>');d.css("float","right"),d.css("display","block"),d.click(function(){c.close(!0)}),jQuery(".depgraphlib-box-header",this.object).append(d)}return b.position&&(this.object.css("top",b.position.y),this.object.css("left",b.position.x)),b.draggable&&this.object.draggable(),b.autodestroy&&(this.tooltipCreationBug=!0,d3.select(document).on("click.box_"+a.Box.instances.length,function(){c.tooltipCreationBug||jQuery.contains(c.object[0],d3.event.originalTarget)||c.close(!0),delete c.tooltipCreationBug})),jQuery("body").append(this.object),this},a.Box.prototype.setContent=function(a){var b=jQuery(".depgraphlib-box-content",this.object);return b.html(a.html()),this},a.Box.prototype.setHeader=function(){return this},a.Box.prototype.setFooter=function(){return this},a.Box.instances=a.Box.instances||[],a.Box.prototype.open=function(a){if(a){var b=a;if("function"==typeof a.getBoundingClientRect){var c=this.getBoundingClientRect();b={x:c.left,y:c.top+c.height+2}}this.object.css("top",b.y),this.object.css("left",b.x)}return this.options.forceToolbar&&this.viewer&&(this.oldFixedToolbarValue=this.viewer.fixedToolbar,this.viewer.fixedToolbar=!0,this.viewer.toolbar.show()),this.object.show(),this},a.Box.prototype.getDOM=function(a){return a?this.dom:this.object},a.Box.getBox=function(b){for(var c=0;c<a.Box.instances.length;++c)if(jQuery.contains(a.Box.instances[c].object[0],b))return a.Box.instances[c]},a.Box.prototype.close=function(a){this.options.forceToolbar&&this.viewer&&(this.viewer.fixedToolbar=this.oldFixedToolbarValue),a?this.destroy():this.object.hide()},a.Box.prototype.destroy=function(){this.object.remove()}}(window.depgraphlib),function(a){a.ui={addTextField:function(a,b){var c="<tr><td><label>"+a+'</label></td><td><input type="text" ';for(var d in b)c+=d+'="'+b[d]+'" ';return c+="></td></tr>"},addCustomField:function(a,b){var c="<tr><td><label>"+a+"</label> </td><td>";return c+=b,c+="</td></tr>"},groupFields:function(a,b,c){var d="<tr><td><label>"+a+"</label></td><td><table ";for(var e in b)d+=e+'="'+b[e]+'" ';if(d+=">","string"==typeof c)d+=c;else{if("array"!=typeof c)throw"Wrong parameter type for fields in function groupFields";for(var f=0;f<c.length;f++)d+=c[f]}return d+="</table></td></tr>"},simpleColorPicker:function(a,b,c){var d='<table name="simpleColorPicker" data-rel="'+c+'"><tr><td><input type="text" name="'+a+'" value="'+b+'" onkeydown="jQuery(jQuery(jQuery(this).parent().parent().children()[1]).children()[0]).css(\'background-color\',this.value+String.fromCharCode(event.keyCode));"></td><td><div style="display:inline-block; width:30px; height:30px; background-color:'+b+';"></div></td></tr></table>';return d},makeTabs:function(a){for(var b='<div class="depgraphlib-tab-menus">',c='<div class="depgraphlib-tab-windows">',d=0;d<a.length;d++)b+='<div class="depgraphlib-tab-menu" tab-index="'+d+'" onclick="depgraphlib.ui.changetab(this);">'+a[d].name+"</div>",c+='<div class="depgraphlib-tab-window">'+a[d].content+"</div>";b+="</div>",c+="</div>",tabcontent='<div class="depgraphlib-tabs-content">'+a[0].content+"</div>";var e='<div><div class="depgraphlib-tabs" selected="0">'+b+tabcontent+c+"</div></div>";return e},changetab:function(a){var b=a.getAttribute("tab-index"),c=a.parentNode.parentNode;c.firstChild.childNodes[c.getAttribute("selected")].setAttribute("class","depgraphlib-tab-menu"),c.setAttribute("selected",b),c.firstChild.childNodes[b].setAttribute("class","depgraphlib-tab-menu depgraphlib-tab-menu-on");var d=c.childNodes[2].childNodes[b].cloneNode(),e=c.childNodes[1].firstChild;c.childNodes[1].replaceChild(d,e)}}}(window.depgraphlib),function(a){a.GraphViewer.prototype.addToolbarItem=function(a){null!=this.getToolbarItem(a.name)&&console.log('warning : adding twice a button of name "'+a.name+'"'),a.state=a.state||!1,a.active=a.active||!0,a.group=a.group||"default"+this.toolbarindex++,this.toolbaritems[a.group]||(this.toolbaritems[a.group]=[]),this.toolbaritems[a.group].push(a),this.applyToolbarConf()},a.GraphViewer.prototype.addToolbarItems=function(a){for(var b=0;b<a.length;b++)this.addToolbarItem(a[b]);this.applyToolbarConf()},a.GraphViewer.prototype.removeToolbarItems=function(a){for(var b=0;b<a.length;b++)this.removeToolbarItem(a[b],!1);this.applyToolbarConf()},a.GraphViewer.prototype.removeToolbarItem=function(){var a=null;for(var b in this.toolbaritems){for(var c=0;c<this.toolbaritems[b].length;c++)if(this.toolbaritems[b][c].name==name){a=this.toolbaritems[b][c];break}if(a){this.toolbaritems[b].splice(c,1);break}}this.applyToolbarConf()},a.GraphViewer.prototype.getToolbarItem=function(a){for(var b in this.toolbaritems)for(var c=0;c<this.toolbaritems[b].length;c++)if(this.toolbaritems[b][c].name==a)return this.toolbaritems[b][c]},a.GraphViewer.prototype.setToolbarItemActive=function(a,b){console.log(this.getToolbarItem(a)),this.getToolbarItem(a).active=b?!0:!1,this.applyToolbarConf()},a.GraphViewer.prototype.applyToolbarConf=function(){for(var a in this.toolbaritems){var b=jQuery("#tb-group-"+this.appendOwnID(a));b&&b.length||(b=jQuery('<div id="tb-group-'+this.appendOwnID(a)+'" class="tab"></div>'));for(var c=!0,d=0;d<this.toolbaritems[a].length;d++){var e=this.toolbaritems[a][d],f=null;"[object Array]"===Object.prototype.toString.call(e.elements)?f=this.createDropDownMenu(e):(f=jQuery("#button-"+this.appendOwnID(e.name)),f&&f.length||(f=jQuery('<div id="button-'+this.appendOwnID(e.name)+'"></div>'),f.attr("title",e.tooltip||e.name),f.attr("class",""),f.addClass("button"),f.addClass("button_off"),e.style?f.addClass(e.style).addClass("icon"):f.html(e.name),e.callback&&f.click(e.callback)),e.active?(c=!1,f.show()):f.hide()),e.button=f,b.append(f)}b.children().length?this.toolbarbuttons.append(b):b.remove(),c?b.hide():b.show()}this.setWidth()},a.GraphViewer.prototype.getButton=function(a){return jQuery("#button-"+this.appendOwnID(a))},a.GraphViewer.prototype.setToolbarItemState=function(a,b){b?jQuery("#button-"+this.appendOwnID(a)).addClass("button_on").removeClass("button_off"):jQuery("#button-"+this.appendOwnID(a)).removeClass("button_on").removeClass("button_on")},a.GraphViewer.prototype.addFullScreenButton=function(){this.allowFullScreen&&"undefined"!=typeof this.container.colorbox&&(this.getToolbarItem("fullscreen")?this.setToolbarItemActive("fullscreen",!0,!0):this.addToolbarItem({name:"fullscreen",callback:null,style:"fullscreen",tooltip:"View in fullscreen"}),this.initFullscreenMode())},a.GraphViewer.prototype.resetToolbarItems=function(){this.toolbaritems={};var a=this.toolbarbuttons.children();a.remove(),this.addFullScreenButton()},a.GraphViewer.prototype.addToolbarButton=function(a,b,c,d,e){var f="";null==d?(d="tab white",f=a):d+=" icon",null==c&&(c="left");var g='<div id="button-'+this.appendOwnID(a)+'" title="'+(e||a)+'" class="'+d+" tab "+c+'">'+f+"</div>";g=jQuery(g),g.click(b),this.toolbarbuttons.append(g)},a.GraphViewer.prototype.removeToolbarButton=function(a){jQuery("#button-"+this.appendOwnID(a)).remove()},a.GraphViewer.prototype.createDropDownMenu=function(a){var b=a.name,c=a.elements,d=a.tooltip,e=jQuery('<div><div class="gv-menu"><div class="gv-menu-header"></div><div class="gv-menu-body"></div></div></div>'),f=jQuery(".gv-menu-header",e),g=jQuery(".gv-menu-body",e);g.hide(),f.html(b),f.attr("title",d||b),f.addClass("white");for(i in c){var h=jQuery("<div>"+i+"</div>");h.attr("title",c[i].tooltip||c[i].name),g.append(h),jQuery(h).click(c[i].callback)}return jQuery(".gv-menu-header",e).click(function(a){jQuery(".gv-menu-body",a.currentTarget.parentNode).slideDown()}),jQuery(e).mouseleave(function(a){jQuery(".gv-menu-body",a.currentTarget).slideUp()}),e}}(window.depgraphlib),function(a){function b(){var b=jQuery(this),c=a.GraphViewer.getInstance(b[0].id);b.parent().animate({bottom:"0px"}),b.removeClass("slide-up"),b.addClass("slide-down"),c.mainpanel.css("border","1px solid grey")}function c(){var b=jQuery(this),c=a.GraphViewer.getInstance(b[0].id),d=b.parent();d.animate({bottom:-d.height()+20+"px"}),b.removeClass("slide-down"),b.addClass("slide-up"),c.mainpanel.css("border","none")}function d(){var a=jQuery(this);a.hasClass("slide-up")?b.call(a):c.call(a)}function e(a){for(var b=0;b<a.length;b++)a[b].method.call(a[b].caller,a[b].args)}a.GraphViewer.prototype.init=function(b,c){null==c&&(c=Math.floor(1e16*Math.random()).toString()),this.allowFullScreen=!0,this.imagemode=!1,this.debugPanelActive=!1,this.fixedToolbar=!1,this._height="600px",this._width="100%",this.basemargin=10,this.margin={top:100,left:0,right:0,bottom:10},this.borders=!0,this.toolbaritems={},this.toolbarindex=0,a.GraphViewer.instances[c]&&(c+="_");var c=this.uid=c;"string"==typeof b&&(b=jQuery(a.jQuerizeID(b)));var b=this.container=b;b.css("display","inline-block");var d=this.mainpanel=this.createDiv("gv-main-panel","gv-main-panel");b.append(d);var e=this.chart=this.createDiv("gv-chart","gv-chart");d.append(e),this.toolbar=this.initToolBar(),this.debugpanel=this.createDebugPanel(),this.tooltip=this.createToolTipPanel(),this.tooltip.hide(),this.altpanel=this.createDiv("gv-alt-panel","gv-alt-panel"),this.altpanelcontent=this.createDiv("alt-panel-content","alt-panel-content"),this.ajaxLoader=this.createDiv("ajax-loader","ajax-loader"),this.ajaxLoader.hide(),this.mainpanel.append(this.ajaxLoader),this.extraDiv=this.createDiv("gv-extra","gv-extra"),this.extraDiv.hide(),this.mainpanel.append(this.extraDiv),d.append(this.tooltip),d.append(this.altpanel),this.altpanel.append(this.altpanelcontent),a.GraphViewer.instances[c]=this,this.callbacks=new Object,this.callbacks.fullscreen=new Object,this.callbacks.fullscreen.oncomplete=[],this.callbacks.fullscreen.onclose=[],this.callbacks.showaltpanel=[],this.callbacks.hidealtpanel=[],this.toolbar.hide(),this.toolbar_landing_area.hover(function(){var b=a.GraphViewer.getInstance(this);b.fixedToolbar||(0==b.toolbar.queue("depgraph_toolbar_hiding_bufferqueue").length?(b.toolbar.slideDown(100,function(){1==b.toolbar.queue("depgraph_toolbar_hiding_bufferqueue").length%2&&b.toolbar.dequeue("depgraph_toolbar_hiding_bufferqueue")}),b.mainpanel.css("border","1px solid grey")):b.toolbar.slideDown({duration:100,queue:"depgraph_toolbar_hiding_bufferqueue"}))},function(){var b=a.GraphViewer.getInstance(this);b.fixedToolbar||(0==b.toolbar.queue("depgraph_toolbar_hiding_bufferqueue").length?(b.toolbar.slideUp(100,function(){1==b.toolbar.queue("depgraph_toolbar_hiding_bufferqueue").length%2&&b.toolbar.dequeue("depgraph_toolbar_hiding_bufferqueue")}),b.borders||b.mainpanel.css("border","none")):b.toolbar.slideUp({duration:100,queue:"depgraph_toolbar_hiding_bufferqueue"}))})},a.GraphViewer.instances=a.GraphViewer.instances||[],a.GraphViewer.getInstance=function(b){var c="";if(a.GraphViewer.prototype.isPrototypeOf(b))return b;c=null!=b.ownerSVGElement?b.ownerSVGElement.parentNode.id:"object"==typeof b&&null!=b.id?b.id:b,regex=/.*-(\w+)/;var d=regex.exec(c),e=null;return null!=d&&(e=a.GraphViewer.instances[d[1]]),null==e&&(e=a.GraphViewer.getInstance(b.parentNode)),e},a.GraphViewer.prototype.initToolBar=function(){var a=this.toolbar_landing_area=this.createDiv("gv-toolbar-landing-area","gv-toolbar-landing-area"),b=this.createDiv("gv-toolbar","gv-toolbar");a.append(b),this.mainpanel.append(this.toolbar_landing_area);var c=this.toolbarbuttons=this.createDiv("gv-toolbarbuttons","gv-toolbarbuttons");return b.append(c),this.addFullScreenButton(),b},a.GraphViewer.prototype.createDebugPanel=function(){var b=this.debugpanel=this.createDiv("gv-debug-panel","gv-debug-panel");this.debugpanelinfo=this.createDiv("debug-panel-info","debug-panel-info"),b.append(this.debugpanelinfo);var e=this.createDiv("debug-panel-slider","debug-panel-slider slider-button slide-up");e.click(d),b.append(e);var f=this.createDiv("debug-panel-fullscreen","debug-panel-fullscreen slider-button maximize");f.click(function(){var b=a.GraphViewer.getInstance(this);if(null!=b){b.viewAltContent("debug-panel-content"+b.appendOwnID(""));var d=jQuery("#debug-panel-slider"+b.appendOwnID(""));d.hasClass("slide-down")&&c.call(d)}}),b.append(f);var g=this.debugcontentcontainer=this.createDiv("debug-panel-container","debug-panel-container");return b.append(g),this.debugpanelcontent=this.createDiv("debug-panel-content","debug-panel-content"),g.append(this.debugpanelcontent),this.mainpanel.append(b),this.adjustDebugHeight(),b.hide(),b},a.GraphViewer.prototype.debugLog=function(a){this.debugpanelcontent.append(a+"<br/>")},a.GraphViewer.prototype.createToolTipPanel=function(){var a=this;this.tooltip=this.createDiv("gv-tooltip","gv-tooltip");var b=jQuery('<div style="display:inline-block;"></div>');return this.tooltip.append(b),this.tooltipExitButton=this.createDiv("tooltip-exit-button","tooltip-exit-button"),this.tooltipExitButton.css("float","right"),this.tooltipExitButton.css("display","block"),this.tooltipExitButton.click(function(){a.hideToolTip()}),b.append(this.tooltipExitButton),this.tooltipExitButton.hide(),this.tooltip.draggable(),this.tooltipContainer=this.createDiv("tooltip-container"),b.append(this.tooltipContainer),this.tooltip},a.GraphViewer.prototype.appendOwnID=function(a){return a.endsWith(this.uid)?a:a+"-"+this.uid},a.GraphViewer.prototype.addWrapper=function(a){var b=this,c=this.wrapper=b.createElement("a","gv-wrapper","gv-wrapper");return c.html(a),b.container.prepend(c),b.mainpanel.hide(),c.click(function(){b.mainpanel.toggle()}),c},a.GraphViewer.prototype.createDiv=function(a,b){return this.createElement("div",a,b)},a.GraphViewer.prototype.createElement=function(a,b,c){c=null!=c?'class="'+c+'"':"";var d="<"+a+' id="'+this.appendOwnID(b)+'" '+c+"></"+a+">";return jQuery(d)},a.GraphViewer.prototype.adjustDebugHeight=function(){var a=this.mainpanel.height()-this.toolbar.height();this.debugpanel.css("height",a),this.debugcontentcontainer.css("height",a-20),this.debugpanel.css("bottom",-a+20)},a.GraphViewer.prototype.shrinkHeightToContent=function(b){null==b&&(b=0);var c=d3.select(this.chart.children()[0]).select("g"),d=c.node().getBBox(),e=a.getTransformValues(c);this.setHeight(e.translate[1]+d.y*e.scale[0]+d.height*e.scale[0]+b*e.scale[0])},a.GraphViewer.prototype.shrinkWidthToContent=function(b){null==b&&(b=0);var c=d3.select(this.chart.children()[0]).select("g"),d=c.node().getBBox(),e=a.getTransformValues(c);this.setWidth(e.translate[0]+d.x+d.width+marginLeft)},a.GraphViewer.prototype.shrinkToContent=function(b,c){null==c&&(c=0),null==b&&(b=0);var d=d3.select(this.chart.children()[0]).select("g"),e=d.node().getBBox(),f=a.getTransformValues(d);this.mainpanel.width();var g=f.translate[0]+e.x+e.width+b;this.setSize(g,f.translate[1]+e.y+e.height+c)},a.GraphViewer.prototype.setSize=function(a,b){this.setWidth(a),this.setHeight(b)},a.GraphViewer.prototype.setImageMode=function(a){null==a&&(a=!0),this.imagemode=a,a?(this.toolbar.detach(),this.debugpanel.detach(),this.tooltip.detach()):(this.mainpanel.append(this.toolbar),this.mainpanel.append(this.debugpanel),this.mainpanel.append(this.tooltip)),this.margin.top=this.chart.height()/10+this.basemargin+(this.imagemode?0:20),this.margin.bottom=this.basemargin+(this.imagemode?0:20)},a.GraphViewer.prototype.noBorders=function(){this.borders=!1,this.mainpanel.css("border","none")},a.GraphViewer.prototype.debugMode=function(a){null==a&&(a=!0),this.debugPanelActive=a,a?this.debugpanel.show():this.debugpanel.hide()},a.GraphViewer.prototype.setWidth=function(a){if(a||(a=this.mainpanel.width()),this._width=a,this.mainpanel.css("width",a),this.ajaxLoader&&this.ajaxLoader.width(a),this.toolbar)for(;this.toolbar.height()>50;)a+=50,this.setWidth(a)},a.GraphViewer.prototype.setHeight=function(a){a+=30,this._height=a,this.mainpanel.css("height",a),this.margin.top=this.chart.height()/10+this.basemargin+(this.imagemode?0:20),this.margin.bottom=this.basemargin+this.imagemode?0:20,this.ajaxLoader.height(a-this.toolbar.height()),this.ajaxLoader.css("top",this.toolbar.height()),this.debugPanelActive&&this.adjustDebugHeight()},a.GraphViewer.prototype.setFixedToolbar=function(a){null==a&&(a=!0),this.fixedToolbar=a,a?this.toolbar.show():this.toolbar.hide()},a.GraphViewer.prototype.viewAltContent=function(a){this.resetAltPanel(),this.addContentToAltPanel(a),this.showAltPanel()},a.GraphViewer.prototype.hideAltPanel=function(){this.chart.show(),this.altpanel.hide(),this.removeToolbarButton("back"),e(this.callbacks.hidealtpanel)},a.GraphViewer.prototype.showAltPanel=function(){this.chart.hide(),this.altpanel.show(),this.addToolbarButton("back",function(){a.GraphViewer.getInstance(this.id).hideAltPanel()},"left","back"),e(this.callbacks.showaltpanel)},a.GraphViewer.prototype.addContentToAltPanel=function(b,c){this.altpanelcontent.html(jQuery("#"+this.appendOwnID(b)).html()),null!=c&&this.addToolbarButton(c,function(){a.GraphViewer.getInstance(this.id).addContentOnAltPanel(b)},"left")},a.GraphViewer.prototype.resetAltPanel=function(){this.altpanelcontent.html("")},a.GraphViewer.prototype.loadTooltipContent=function(b){var c,d=a.GraphViewer.getInstance(this);c="string"==typeof b?jQuery("#"+d.appendOwnID(b)):b,d.tooltipContainer.html(c.html())},a.GraphViewer.prototype.showTooltip=function(b){var c=a.GraphViewer.getInstance(this);c.tooltip.css("left",b.x),c.tooltip.css("top",b.y),c.tooltip.show()},a.GraphViewer.prototype.hideToolTip=function(){var b=a.GraphViewer.getInstance(this);b.tooltip.hide()},a.GraphViewer.prototype.ajaxStart=function(){this.ajaxLoader.show()},a.GraphViewer.prototype.ajaxFinished=function(){this.ajaxLoader.hide()},a.GraphViewer.prototype.initFullscreenMode=function(){var a=this,b=a.getToolbarItem("fullscreen").button;b.colorbox({inline:!0,href:"#gv-main-panel"+a.appendOwnID(""),width:"95%",height:"95%",onLoad:function(){a.setToolbarItemActive("fullscreen",!1,!0),a.mainpanel.width("99%"),a.mainpanel.height("99%")},onComplete:function(){a.adjustDebugHeight(),e(a.callbacks.fullscreen.oncomplete)},onClosed:function(){a.mainpanel.width(a._width),a.mainpanel.height(a._height),a.setToolbarItemActive("fullscreen",!0,!0),a.adjustDebugHeight(),a.initFullscreenMode(),e(a.callbacks.fullscreen.onclose)}})},String.prototype.endsWith=function(a){return-1!==this.indexOf(a,this.length-a.length)},a.GraphViewer.prototype.screenCoordsForElt=function(a){for(;"[object Array]"===Object.prototype.toString.call(a);)a=a[0];var b=a.getBBox(),c=this.chart[0].querySelector("svg"),d=c.createSVGPoint(),e={},f=a.getScreenCTM();return d.x=b.x,d.y=b.y,e.nw=d.matrixTransform(f),d.x+=b.width,e.ne=d.matrixTransform(f),d.y+=b.height,e.se=d.matrixTransform(f),d.x-=b.width,e.sw=d.matrixTransform(f),e}}(window.depgraphlib),function(a){function b(b,c){return 2*a.getNodePosition(b)<2*c.min||2*a.getNodePosition(b)>2*c.max}function c(b,c){return 2*a.getNodePosition(b)>2*c.min&&2*a.getNodePosition(b)<2*c.max}a.DepGraph.prototype.crossed=function(a,d){var e=this.getLinkProperties(a),f=this.getLinkProperties(d);return c(e.nodeStart,f)&&b(e.nodeEnd,f)||c(e.nodeEnd,f)&&b(e.nodeStart,f)},a.DepGraph.prototype.preprocessLinksPosition=function(a){function b(a){var b=Math.abs(a);c.maxLinksStrate=c.maxLinksStrate<b?b:c.maxLinksStrate}var c=this;this.sortLinksByLength(a[0]);for(var d=a[0].length,e=[],f=0;d>f;++f){var g=a[0][f],h=this.getLinkProperties(g);if(h.min!=h.max)for(var i=1;;){if(null==e[i]){e[i]=new Array,h.strate=i,b(i);for(var j=i;j>0;j--)for(var k=2*h.min+1;k<2*h.max+1;k++)e[j][k]||(e[j][k]=g);break}for(var l=null,k=2*h.min+1;k<2*h.max+1&&(null==e[i][k]||(l=e[i][k],!this.crossed(g,l)));k++);if(null==l){for(var j=i;j>0;j--)for(var k=2*h.min+1;k<2*h.max+1;k++)e[j][k]||(e[j][k]=g);h.strate=i,b(i);break}if(this.crossed(g,l)){for(i=-1;;){if(null==e[i]){e[i]=new Array;for(var j=i;0>j;j++)for(var k=2*h.min+1;k<2*h.max+1;k++)e[j][k]||(e[j][k]=g);h.strate=i,b(i);break}for(var m=null,k=2*h.min+1;k<2*h.max+1;k++)if(null!=e[i][k]){m=e[i][k];break}if(null==m){for(var j=i;0>j;j++)for(var k=2*h.min+1;k<2*h.max+1;k++)e[j][k]||(e[j][k]=g);h.strate=i,b(i);break}i--}break}i++}else h.strate=1,b(1),e[1]=new Array,e[1][2*h.min+1]=g}for(var f=0;d>f;f++){var n,g=a[0][f],h=this.getLinkProperties(g);n=h.strate>0?-1:1;for(var i=h.strate;0!=i;i+=n){var o=e[i][2*h.min+1];if(null!=o&&o!=g){var p=this.getLinkProperties(o);p.min==h.min&&p.offsetXmin++}if(o=e[i][2*h.max],null!=o&&o!=g){var p=this.getLinkProperties(o);p.max==h.max&&p.offsetXmax++}}}},a.DepGraph.prototype.sortLinksByLength=function(a){var b=this;a.sort(function(a,c){return b.getLinkProperties(a).length-b.getLinkProperties(c).length})},a.DepGraph.prototype.getLinkProperties=function(b){var c=b.__data__;if(null==c["#properties"]){var d=new Object;d.nodeStart=this.getWordNodeByOriginalId(c.source),null==d.nodeStart&&(d.nodeStart=this.getChunkNodeByOriginalId(c.source)),d.nodeEnd=this.getWordNodeByOriginalId(c.target),null==d.nodeEnd&&(d.nodeEnd=this.getChunkNodeByOriginalId(c.target));var e=a.getNodePosition(d.nodeStart),f=a.getNodePosition(d.nodeEnd);-1==e||-1==f?(d.min=d.max=-1!=e?e:f,d.hdir=1):f>e?(d.min=e,d.max=f,d.hdir=1):(d.max=e,d.min=f,d.hdir=-1),d.vdir=1,d.offsetXmax=0,d.offsetXmin=0,d.strate=0,d.length=d.max-d.min,d.outer=0,c["#properties"]=d}return c["#properties"]},a.DepGraph.prototype.resetLinksProperties=function(a){a.each(function(a){a["#properties"]=null}),this.maxLinksStrate=0}}(window.depgraphlib),function(a){function b(b,c){var d=d3.select(this),e=d.node(),f=e.getStyle("font-size"),g=e.getStyle("sub-font-size"),h=e.getStyle("color"),i=e.getStyle("sub-color"),j=e.getStyle("font-weight"),k=e.getStyle("sub-font-weight"),l=e.getStyle("font-style"),m=e.getStyle("sub-font-style"),n=null!=e.components?e.components.rect:d.append("rect"),o=null!=e.components?e.components.text:d.append("text"),p=null!=e.components?e.components.label:o.append("tspan"),q=null!=e.components?e.components.sublabels:[];if(p.text(b.label).style("fill",h).style("font-style",l).style("font-weight",j).style("font-size",f),b.sublabel)for(var c=0;c<b.sublabel.length;++c){var r=null;null!=q[c]?r=q[c]:(r=o.append("tspan"),q.push(r)),r.text(b.sublabel[c]).style("font-size",g).style("font-style",m).style("font-weight",k).style("fill",i).attr("x","0px").attr("dy","1.25em")}var s="none";(null!=b.selected||e.getStyle("highlighted",!1))&&(s="yellow");var t=o.node().getBBox();n.attr("x",0).attr("y",t.y).attr("rx",10).attr("ry",10).attr("width",t.width).attr("height",t.height).style("stroke","transparent").style("fill",s).style("stroke-width",1);var u=a.DepGraph.getInstance(this),v=u.getWordNodeByPosition(d.datum()["#position"]-1),w=e.getStyle("margin");if(null!=v){var x=a.getTransformValues(d3.select(v)),t=v.getBBox(),y=a.removeUnit(a.addPxs(x.translate[0],t.width,w.right,w.left)),z=a.removeUnit(w.top);a.setGroupPosition(d,y,z)}else{var y=a.removeUnit(w.left),z=a.removeUnit(w.top);a.setGroupPosition(d,y,z)}d.node().components={text:o,label:p,rect:n,sublabels:q}}function c(b,c){var d=d3.select(this),e=a.DepGraph.getInstance(d.node()),f=d.node();f.components=f.components||{};for(var g=f.components.rect||d.append("rect"),h={x:99999,y:99999},i={x:0,y:0},c=0;c<b.elements.length;c++){var j=e.getWordNodeByOriginalId(b.elements[c]),k=a.getTransformValues(d3.select(j)),l={x:k.translate[0],y:k.translate[1]},m=j.getBBox();l.x+m.x<h.x&&(h.x=l.x+m.x),l.y+m.y<h.y&&(h.y=l.y+m.y),l.x+m.width+m.x>i.x&&(i.x=l.x+m.width+m.x),l.y+m.height+m.y>i.y&&(i.y=l.y+m.height+m.y)}var n=f.getStyle("margin"),o=f.getStyle("font-size"),p=f.getStyle("sub-font-size"),q=f.getStyle("color"),r=f.getStyle("sub-color"),s=f.getStyle("font-weight"),t=f.getStyle("sub-font-weight"),u=f.getStyle("font-style"),v=f.getStyle("sub-font-style"),w=f.getStyle("background-color"),x=f.getStyle("border-color"),y=f.getStyle("border-size"),z=f.components.line||d.append("line");z.attr("y1",a.addPxs(i.y,2*a.removeUnit(n.top))).attr("x1",0).attr("y2",a.addPxs(i.y,2*a.removeUnit(n.top))).attr("x2",i.x-h.x+a.removeUnit(n.left)+a.removeUnit(n.right)).style("stroke",x).style("stroke-width",y);var A=f.components.text||d.append("text"),B=f.components.label||A.append("tspan"),C=f.components.sublabels||[];if(A.attr("y",a.addPxs(20,i.y,2*a.removeUnit(n.top))),B.text(b.label).style("fill",q).style("font-style",u).style("font-weight",s).style("font-size",o),b.sublabel)for(var c=0;c<b.sublabel.length;++c){var D=null;null!=C[c]?D=C[c]:(D=A.append("tspan"),C.push(D)),D.text(b.sublabel[c]).style("font-size",p).style("font-style",v).style("font-weight",t).style("fill",r).attr("dx",-(b.sublabel[c].length-1)*a.removeUnit(p)).attr("dy","1.25em")}var E=A.node().getBBox().height;g.attr("x",0).attr("y",0).attr("rx",10).attr("ry",10).attr("width",i.x-h.x+a.removeUnit(n.left)+a.removeUnit(n.right)).attr("height",a.addPxs(i.y,-h.y,E,2*a.removeUnit(n.top),20)).style("fill",w).style("stroke",x).style("stroke-width",y),a.center(A,g),d.node().components={text:A,rect:g,line:z,sublabels:C,label:B},a.setGroupPosition(d,h.x-a.removeUnit(n.left),h.y-a.removeUnit(n.top))}function d(b,c){var d=d3.select(this),f=a.DepGraph.getInstance(this),g=this,h=f.getLinkProperties(d.node()),i=g.getStyle("margin"),j=g.getStyle("font-size"),k=g.getStyle("color"),l=g.getStyle("link-color"),m=g.getStyle("link-size"),n=g.getStyle("font-weight"),o=g.getStyle("font-style"),p=g.getStyle("oriented");g.getStyle("align");var q=g.getStyle("highlighted",!1),r=g.getStyle("stroke-dasharray","none"),s=!1;h.nodeStart||(h.nodeStart=h.nodeEnd,s=!0);var t=a.getNodePosition(h.nodeEnd)-a.getNodePosition(h.nodeStart)>0?1:-1,u=h.strate>0?1:-1,v=a.getTransformValues(d3.select(h.nodeStart)).translate,w=a.getTransformValues(d3.select(h.nodeEnd)).translate,x=h.nodeStart.getBBox(),y=h.nodeEnd.getBBox(),z=x.width/2,A=y.width/2,B=3,C=t>0?5*h.offsetXmin+B:-5*h.offsetXmax-B,D=t>0?-5*h.offsetXmax-B:5*h.offsetXmin+B,E=5,F=v[0]+z+C,G=w[0]+A+D,H=G-F-2*t*E;if(null==f.wordY){var I=f.vis.selectAll("g.word");f.wordY=0,f.wordHeight=0;for(var c=0;c<I[0].length;++c){var J=I[0][c].getBBox();f.wordY>J.y&&(f.wordY=J.y),f.wordHeight<J.height&&(f.wordHeight=J.height)}}var K="chunk"==h.nodeStart.className.animVal?x.height:x.height+f.wordY,L="chunk"==h.nodeEnd.className.animVal?y.height:y.height+f.wordY,M="chunk"==h.nodeStart.className.animVal?0:f.wordY,N="chunk"==h.nodeEnd.className.animVal?0:f.wordY,O=u>0?M:K,P=u>0?N:L,Q=v[1]+O,R=w[1]+P,S=15,T=30,U=-u*S-T*h.strate;s&&(U=-u*S-T*u*(f.maxLinksStrate+1));var V=-(U+Q-R),W=(1+t*u)/2,X=(1+t*u)/2,Y="transparent";q&&(Y=e(l));var Z=null!=g.components?g.components.highlightPath:d.append("path"),$=null!=g.components?g.components.path:d.append("path");s?(Z.attr("d","M "+F+","+(Q+U)+" v "+-U),$.attr("d","M "+F+","+(Q+U)+" v "+-U)):(Z.attr("d","M "+F+","+Q+" v "+U+" a 5 5 0 0 "+W+" "+t*E+" "+-u*E+" h "+H+" a 5 5 0 0 "+X+" "+t*E+" "+u*E+" v "+V),$.attr("d","M "+F+","+Q+" v "+U+" a 5 5 0 0 "+W+" "+t*E+" "+-u*E+" h "+H+" a 5 5 0 0 "+X+" "+t*E+" "+u*E+" v "+V)),Z.attr("stroke",Y).attr("stroke-width",a.removeUnit(m)+3).attr("fill","none"),$.attr("stroke",l).attr("stroke-dasharray",r).attr("stroke-width",m).attr("fill","none"),p&&$.attr("marker-end","url(#"+f.viewer.appendOwnID("arrow")+")");var _=null!=g.components?g.components.label:d.append("text");_.text(b.label).style("fill",k).style("font-weight",n).style("font-style",o).style("font-size",j);var ab=_.node().getBBox();_.attr("x",-ab.width/2+F+H/2+t*E).attr("y",a.removeUnit(a.addPxs(-a.removeUnit(i.top),Q,U,-u*E))),g.components={highlightPath:Z,path:$,label:_}}function e(b){if("#000000"==b||"#"!=b.slice(0,1))return"yellow";var c=-.3,d=a.hexToRgb(b),e=a.rgbToHsl(d.r,d.g,d.b);return e.l+=c,e.l=e.l<0?0:e.l>1?1:e.l,d=a.hslToRgb(e.h,e.s,e.l),a.rgbToHex(d.r,d.g,d.b)}a.DepGraph.prototype.init=function(b,c,d){this.options=d||{},this.viewer=new a.GraphViewer(b,this.options.uid),a.DepGraph.instances[this.viewer.uid]=this,this.callbacks=new Object,this.setData(c),this.original_data=a.clone(this.data),this.createLayout(),this.update(),this.postProcesses(),this.autoHighLightOnMouseOver(),this.viewerSettings(),this.editObject=new a.EditObject(this)},a.DepGraph.prototype.getOriginalUID=function(){return this.viewer.uid.replace(/_*$/g,"")},a.DepGraph.prototype.viewerSettings=function(){this.viewer.callbacks.fullscreen.oncomplete.push({method:this.centerGraph,caller:this}),this.viewer.callbacks.fullscreen.onclose.push({method:this.centerGraph,caller:this})
},a.DepGraph.prototype.centerGraph=function(){var b=this.viewer.chart,c=b[0].getBoundingClientRect(),d=this.vis.node().getBBox(),e=a.getTransformValues(this.vis),f=(c.width-d.width)/2,g=(c.height-d.height)/2;g=g>0?g:a.removeUnit(this.data.graph["#style"].margin.top),f=f>0?f:a.removeUnit(this.data.graph["#style"].margin.left),this.vis.attr("transform","translate("+(f-d.x)+","+(g-d.y)+") scale("+e.scale[0]+")")},a.DepGraph.prototype.autoHighLightOnMouseOver=function(b){null==b||b?(this.vis.selectAll("g.link").on("mouseover.autohighlight",function(){a.DepGraph.highlightLink(this,!0)}),this.vis.selectAll("g.link").on("mouseout.autohighlight",function(){a.DepGraph.highlightLink(this,!1)}),this.vis.selectAll("g.word").on("mouseover.autohighlight",function(){a.DepGraph.highlightWord(this,!0)}),this.vis.selectAll("g.word").on("mouseout.autohighlight",function(){a.DepGraph.highlightWord(this,!1)})):(this.vis.selectAll("g.link").on("mouseover.autohighlight",null),this.vis.selectAll("g.link").on("mouseout.autohighlight",null),this.vis.selectAll("g.word").on("mouseover.autohighlight",null),this.vis.selectAll("g.word").on("mouseout.autohighlight",null))},a.DepGraph.instances=a.DepGraph.instances||[],a.DepGraph.getInstance=function(b){if(b){if(a.DepGraph.prototype.isPrototypeOf(b))return b;null!=b.ownerSVGElement?b=b.ownerSVGElement.parentNode.id:b.nodeName&&"svg"==b.nodeName?b=b.parentNode.id:"object"==typeof b&&null!=b.id&&(b=b.id),regex=/.*-(\w+)/;var c=regex.exec(b);return null!=c?a.DepGraph.instances[c[1]]:null}},a.DepGraph.prototype.setData=function(a){this.data=a,this.prepareData()},a.DepGraph.prototype.resetData=function(a){console.log(a),this.setData(a),this.createLayout(),this.update(),this.postProcesses(),this.autoHighLightOnMouseOver(),this.editObject.editModeInit()},a.DepGraph.prototype.cleanData=function(){var a=this.vis.selectAll("g.link");this.resetLinksProperties(a)},a.DepGraph.prototype.postProcesses=function(){var b=this.vis.node().getBBox();this.vis.attr("transform","translate("+(a.removeUnit(this.data.graph["#style"].margin.left)-b.x)+","+(a.removeUnit(this.data.graph["#style"].margin.top)-b.y)+") scale(1)"),this.setViewMode()},a.DepGraph.prototype.setViewMode=function(){if(this.options.viewmode&&"full"!=this.options.viewmode)this.setWidthLimitedViewMode("600px");else{var a=this.vis.node().getBBox();this.options.maxwidth&&this.options.maxwidth<a.width?(this.options.viewmode="cropped",this.setWidthLimitedViewMode(this.options.maxwidth,!0)):(this.options.viewmode="full",this.setFullViewMode())}},a.DepGraph.prototype.setFullViewMode=function(){this.viewer.shrinkToContent(a.removeUnit(this.data.graph["#style"].margin.right),a.removeUnit(this.data.graph["#style"].margin.bottom)+20)},a.DepGraph.prototype.setWidthLimitedViewMode=function(b,c){if(this.viewer.shrinkHeightToContent(a.removeUnit(this.data.graph["#style"].margin.bottom)+20),this.options.viewsize||(this.options.viewsize=b),this.viewer.setWidth(this.options.viewsize),c||"cropped"==this.options.viewmode)this.createScrollBar();else{var d=this.vis.node().getBBox(),e=this.viewer.chart.width()/(d.width+2*a.removeUnit(this.data.graph["#style"].margin.right));this.scale(e),this.viewer.shrinkHeightToContent(a.removeUnit(this.data.graph["#style"].margin.bottom)+20)}},a.DepGraph.prototype.createScrollBar=function(){var b=this,c=this.vis.node().getBBox(),d=c.width+2*a.removeUnit(this.data.graph["#style"].margin.right),e=this.viewer.mainpanel.width();if(d>e){var f=2*e-d,g=1;0>=f&&(f=20,g=(d-e)/(e-f)),this.scrollbar=this.svg.select(".scrollbar"),null==this.scrollbar.node()&&(this.scrollbar=this.svg.append("rect").classed("scrollbar",!0)),this.scrollbar.attr("x",0).attr("y",this.viewer.mainpanel.height()-40).attr("rx",1).attr("ry",1).attr("width",f).attr("height",5).style("stroke","grey").style("fill","lightgrey").style("stroke-width",1).__info__={maxX:e-f,k:g},this.scrollMouseSelected=null,this.scrollbar.on("mousedown",function(){var b=a.DepGraph.getInstance(this);a.DepGraph.depgraphActive="-"+b.viewer.uid,b.scrollMouseSelected=d3.event.clientX,d3.event.preventDefault?d3.event.preventDefault():d3.event.returnValue=!1}),d3.select(document).on("click.focus",function(){var b=a.DepGraph.getInstance(d3.event.originalTarget);a.DepGraph.depgraphActive=b?"-"+b.viewer.uid:null}),d3.select(document).on("wheel.scrollbar",function(){var b=a.DepGraph.getInstance(a.DepGraph.depgraphActive);b&&b.scrollbar&&(b.translateGraph(3*d3.event.deltaY,0),d3.event.preventDefault?d3.event.preventDefault():d3.event.returnValue=!1)}),d3.select(document).on("mousemove.scrollbar"+b.viewer.uid,function(){var b=a.DepGraph.getInstance(a.DepGraph.depgraphActive);if(b&&(b.scrollMouseSelected||0===b.scrollMouseSelected)){var c=d3.event.clientX-b.scrollMouseSelected;b.scrollbar&&(c*=b.scrollbar.__info__.k),b.translateGraph(c,0),b.scrollMouseSelected=d3.event.clientX}}),d3.select(document).on("mouseup.scrollbar"+b.viewer.uid,function(){var b=a.DepGraph.getInstance(a.DepGraph.depgraphActive);b&&(b.scrollMouseSelected=null)})}d3.select(document).on("keydown.move"+b.viewer.uid,function(){var b=10;if(a.DepGraph.depgraphActive){var c=a.DepGraph.getInstance(a.DepGraph.depgraphActive);37==d3.event.keyCode?c.translateGraph(-b,0):39==d3.event.keyCode&&c.translateGraph(b,0)}})},a.DepGraph.prototype.createLayout=function(){null!=this.svg&&this.svg.remove(),this.svg=d3.select(this.viewer.chart[0]).append("svg").attr("width","100%").attr("height","100%").style("margin-top","30px"),this.viewer.chart.css("background-color",this.data.graph["#style"]["background-color"]),this.svg.append("rect").classed("export_bg",!0).attr("width","0").attr("height","0").style("fill",this.data.graph["#style"]["background-color"]),this.setSVGDefs(),this.vis=this.svg.append("g").attr("transform","translate("+a.removeUnit(this.data.graph["#style"].margin.left)+","+a.removeUnit(this.data.graph["#style"].margin.top)+") scale(1)")},a.DepGraph.prototype.scale=function(b){var c=a.DepGraph.getInstance(this),d=a.getTransformValues(c.vis);c.vis.attr("transform","translate("+d.translate[0]*b+","+d.translate[1]*b+")"+" scale("+b+")")},a.DepGraph.prototype.translateGraph=function(b,c){var d=a.DepGraph.getInstance(this),e=a.getTransformValues(d.vis);if(d.scrollbar){var f=parseFloat(d.scrollbar.attr("x")),g=b/d.scrollbar.__info__.k;d.scrollbar.__info__.maxX<f+g?g=d.scrollbar.__info__.maxX-f:0>f+g&&(g=-f),b=d.scrollbar.__info__.k*g,d.scrollbar.attr("x",f+g)}d.vis.attr("transform","translate("+(e.translate[0]-b)+","+(e.translate[1]-c)+")"+" scale("+e.scale[0]+")")},a.DepGraph.prototype.update=function(){var a=this.words=this.vis.selectAll("g.word").data(this.data.graph.words,function(a){return a["#id"]});a.enter().append("g").classed("word",!0);var e=a.exit();e.remove(),a.each(b);var f=this.chunks=this.vis.selectAll("g.chunk").data(this.data.graph.chunks,function(a){return a["#id"]});f.enter().insert("g","g.word").classed("chunk",!0);var g=f.exit();g.remove(),f.each(c);var h=this.links=this.vis.selectAll("g.link").data(this.data.graph.links,function(a){return a["#id"]});h.enter().append("g").classed("link",!0);var i=h.exit();i.remove(),this.resetLinksProperties(h),this.preprocessLinksPosition(h),h.each(d)},a.DepGraph.prototype.insertWord=function(a,b){null==a["#id"]&&(a["#id"]=this.id++),null==a.id&&(a.id="_w"+a["#id"]),this.data.graph.words.splice(b,0,a);for(var c=b+1;c<this.data.graph.words.length;++c)this.data.graph.words[c]["#position"]++;this.update(),this.postProcesses(),this.editObject.editModeInit(),this.autoHighLightOnMouseOver()},a.DepGraph.prototype.insertLink=function(a){null==a["#id"]&&(a["#id"]=this.id++),this.data.graph.links.push(a),this.update(),this.postProcesses(),this.editObject.editModeInit(),this.autoHighLightOnMouseOver()},a.DepGraph.prototype.insertChunk=function(a){this.data.graph.chunks.push(a),this.update(),this.postProcesses(),this.editObject.editModeInit(),this.autoHighLightOnMouseOver()},a.DepGraph.prototype.removeWord=function(b){var c=[],d=this.getWordIndexById(b);if(null==d)return!1;var e=this.data.graph.words[d]["#position"],f=this.data.graph.words[d].id;this.data.graph.words.splice(d,1);for(var g=e;g<this.data.graph.words.length;++g)this.data.graph.words[g]["#position"]--;for(var g=0;g<this.data.graph.links.length;g++){var h=this.data.graph.links[g];(h.source==f||h.target==f)&&(c.push(a.clone(h)),this.data.graph.links.splice(g,1),g--)}return this.update(),this.postProcesses(),c},a.DepGraph.prototype.removeLink=function(a){var b=this.getLinkIndexById(a);return null==b?!1:(this.data.graph.links.splice(b,1),this.update(),this.postProcesses(),!0)},a.DepGraph.prototype.removeChunk=function(b){var c=this.getChunkIndexById(b);if(null==c)return!1;var d=[],e=this.data.graph.chunks[c].id;this.data.graph.chunks.splice(c,1);for(var f=0;f<this.data.graph.links.length;f++){var g=this.data.graph.links[f];(g.source==e||g.target==e)&&(d.push(a.clone(g)),this.data.graph.links.splice(f,1),f--)}return this.update(),this.postProcesses(),d},a.DepGraph.highlightLink=function(b,c,d){if(d||!b.selected&&!b.getStyle("highlighted",!1)){d&&a.setStyle(b,"highlighted",c);var f=b.getStyle("link-color"),g=b.getStyle("font-weight");c!==!1?(b.components.highlightPath.attr("stroke",e(f)),b.components.label.style("font-weight","bold")):(b.components.highlightPath.attr("stroke","transparent"),b.components.label.style("font-weight",g))}},a.DepGraph.highlightWord=function(b,c,d){(d||!b.selected&&!b.getStyle("highlighted",!1))&&(d&&a.setStyle(b,"highlighted",c),b.components.rect.style("fill",c?"yellow":"none"))},a.DepGraph.highlightChunk=function(){},a.DepGraph.highlightObject=function(b,c,d){if(null!=b.classList&&b.classList.length>0){var e=b.classList[0];"link"==e?a.DepGraph.highlightLink(b,c,d):"word"==e?a.DepGraph.highlightWord(b,c,d):"chunk"==e&&a.DepGraph.highlightChunk(b,c,d)}},a.isObjectPermanentHighlighted=function(a){return a.getStyle("highlighted",!1)},a.DepGraph.prototype.setSVGDefs=function(){this.defs=this.svg.append("defs"),this.defs.append("marker").attr("id",this.viewer.appendOwnID("arrow")).attr("viewBox","0 0 10 10").attr("refX","8").attr("refY","5").attr("markerUnits","strokeWidth").attr("orient","auto").attr("markerWidth","3").attr("markerHeight","3").append("polyline").attr("points","0,0 10,5 0,10 1,5")},a.getNodePosition=function(b){if(b){if(null!=b.__data__["#position"])return b.__data__["#position"];var c=a.DepGraph.getInstance(b),d=c.getChunkRange(b.__data__),e=Math.floor(d.firstElement["#position"]+d.lastElement["#position"])/2;return e}return-1}}(window.depgraphlib),function(a){a.DepGraph.prototype.prepareData=function(){a.JSONresolveReferences(this.data,"@"),this.id=0,this.data.graph.words=this.data.graph.words||[],this.data.graph.links=this.data.graph.links||[],this.data.graph.chunks=this.data.graph.chunks||[];for(var b=0;b<this.data.graph.words.length;b++){var c=this.data.graph.words[b];c["#id"]=this.id++,c["#position"]=b}for(var b=0;b<this.data.graph.links.length;b++)this.data.graph.links[b]["#id"]=this.id++,this.data.graph.links[b]["#properties"]=null;for(var b=0;b<this.data.graph.chunks.length;b++)this.data.graph.chunks[b]["#id"]=this.id++;var d=this.data.graph["#style"]?this.data.graph["#style"]:this.data.graph["#style"]=new Object,e=this.data.graph["#word-style"]?this.data.graph["#word-style"]:this.data.graph["#word-style"]=new Object,f=this.data.graph["#link-style"]?this.data.graph["#link-style"]:this.data.graph["#link-style"]=new Object,g=this.data.graph["#chunk-style"]?this.data.graph["#chunk-style"]:this.data.graph["#chunk-style"]=new Object;d.margin=d.margin?d.margin:{top:"50px",right:"20px",bottom:"20px",left:"20px"},d.margin.top=d["margin-top"]?d["margin-top"]:d.margin.top,d.margin.right=d["margin-right"]?d["margin-right"]:d.margin.right,d.margin.left=d["margin-left"]?d["margin-left"]:d.margin.left,d.margin.bottom=d["margin-bottom"]?d["margin-bottom"]:d.margin.bottom,d["background-color"]=d["background-color"]?d["background-color"]:"white",d["font-family"]=d["font-family"]?d["font-family"]:"inherit",e.margin=e.margin?e.margin:{top:"10px",right:"15px",bottom:"10px",left:"15px"},e["sub-margin"]=e["sub-margin"]?e["sub-margin"]:{top:"4px",right:"4px",bottom:"4px",left:"4px"},e["font-size"]=e["font-size"]?e["font-size"]:"14px",e["sub-font-size"]=e["sub-font-size"]?e["sub-font-size"]:"10px",e.color=e.color?e.color:"black",e["sub-color"]=e["sub-color"]?e["sub-color"]:"black",e["font-weight"]=e["font-weight"]?e["font-weight"]:"normal",e["sub-font-weight"]=e["sub-font-weight"]?e["sub-font-weight"]:"normal",e["font-style"]=e["font-style"]?e["font-style"]:"normal",e["sub-font-style"]=e["sub-font-style"]?e["sub-font-style"]:"normal",f.margin=f.margin?f.margin:{top:"5px",right:"10px",bottom:"10px",left:"10px"},f["font-size"]=f["font-size"]?f["font-size"]:"12px",f.color=f.color?f.color:"black",f["link-color"]=f["link-color"]?f["link-color"]:"#000000",f["link-size"]=f["link-size"]?f["link-size"]:"2px",f["font-weight"]=f["font-weight"]?f["font-weight"]:"normal",f["font-style"]=f["font-style"]?f["font-style"]:"normal",f.oriented=f.oriented?f.oriented:!0,f.align=f.align?f.align:"center",f.higlighted=!1,g.margin=g.margin?g.margin:{top:"10px",right:"10px",bottom:"10px",left:"10px"},g["sub-margin"]=g["sub-margin"]?g["sub-margin"]:{top:"4px",right:"4px",bottom:"4px",left:"4px"},g["font-size"]=g["font-size"]?g["font-size"]:"12px",g["sub-font-size"]=g["sub-font-size"]?g["sub-font-size"]:"10px",g["background-color"]=g["background-color"]?g["background-color"]:"transparent",g.color=g.color?g.color:"black",g["sub-color"]=g["sub-color"]?g["sub-color"]:"black",g["border-color"]=g["border-color"]?g["border-color"]:"black",g["font-weight"]=g["font-weight"]?g["font-weight"]:"normal",g["sub-font-weight"]=g["sub-font-weight"]?g["sub-font-weight"]:"normal",g["font-style"]=g["font-style"]?g["font-style"]:"normal",g["sub-font-style"]=g["sub-font-style"]?g["sub-font-style"]:"normal",g["border-size"]=g["border-size"]?g["border-size"]:"1px"},a.isALink=function(a){return null!=a.__data__.target&&null!=a.__data__.source},a.isAWord=function(a){return null!=a.__data__["#position"]},a.isAChunk=function(a){return null!=a.elements},a.DepGraph.prototype.getWordNodeByPosition=function(a){for(var b=this.vis.selectAll("g.word"),c=0;c<b[0].length;c++)if(b[0][c].__data__["#position"]==a)return b[0][c];return null},a.DepGraph.prototype.getWordNodeByOriginalId=function(a){for(var b=this.vis.selectAll("g.word"),c=0;c<b[0].length;c++)if(b[0][c].__data__.id==a)return b[0][c]},a.DepGraph.prototype.getChunkNodeByOriginalId=function(a){for(var b=this.vis.selectAll("g.chunk"),c=0;c<b[0].length;c++)if(b[0][c].__data__.id==a)return b[0][c]},a.DepGraph.prototype.getWordNodeById=function(a){for(var b=this.vis.selectAll("g.word"),c=0;c<b[0].length;c++)if(b[0][c].__data__["#id"]==a)return b[0][c]},a.DepGraph.prototype.getWordByOriginalId=function(a){for(var b in this.data.graph.words)if(this.data.graph.words[b].id==a)return this.data.graph.words[b]},a.DepGraph.prototype.getWordIndexById=function(a){for(var b in this.data.graph.words)if(this.data.graph.words[b]["#id"]==a)return b},a.DepGraph.prototype.getLinkById=function(a){for(var b in this.data.graph.links)if(this.data.graph.links[b]["#id"]==a)return this.data.graph.links[b]},a.DepGraph.prototype.getLinkIndexById=function(a){for(var b in this.data.graph.links)if(this.data.graph.links[b]["#id"]==a)return b},a.DepGraph.prototype.getLinkIndexByOriginalId=function(a){for(var b in this.data.graph.links)if(this.data.graph.links[b].id==a)return b},a.DepGraph.prototype.getChunkIndexById=function(a){for(var b in this.data.graph.chunks)if(this.data.graph.chunks[b]["#id"]==a)return b},a.DepGraph.prototype.getObjectById=function(a){for(var b in this.data.graph.words)if(this.data.graph.words[b]["#id"]==a)return this.data.graph.words[b];for(var b in this.data.graph.links)if(this.data.graph.links[b]["#id"]==a)return this.data.graph.links[b];for(var b in this.data.graph.chunks)if(this.data.graph.chunks[b]["#id"]==a)return this.data.graph.chunks[b]},a.DepGraph.prototype.getObjectNodeByOriginalId=function(a){for(var b=this.vis.selectAll("g.word"),c=0;c<b[0].length;c++)if(b[0][c].__data__.id==a)return b[0][c];b=this.vis.selectAll("g.chunk");for(var c=0;c<b[0].length;c++)if(b[0][c].__data__.id==a)return b[0][c];b=this.vis.selectAll("g.link");for(var c=0;c<b[0].length;c++)if(b[0][c].__data__.id==a)return b[0][c]},a.DepGraph.prototype.getObjectNodeFromObject=function(){},a.getStyleElement=function(a,b,c){return null!=a.__data__["#style"]&&null!=a.__data__["#style"][b]?a.__data__["#style"][b]:c},SVGElement.prototype.getStyle=function(b,c){var d=a.DepGraph.getInstance(this);if(null!=this.__data__["#style"]&&null!=this.__data__["#style"][b])return this.__data__["#style"][b];var e=null;return null!=this.className&&(e=d.data.graph["#"+this.className.animVal+"-style"][b]),null==e&&null!=c?c:e},a.setStyle=function(a,b,c){null==a.__data__["#style"]&&(a.__data__["#style"]={}),c?a.__data__["#style"][b]=c:delete a.__data__["#style"][b]},a.DepGraph.prototype.addWord=function(b){var c=b["#position"]||this.data.words.length;return this.insertWord(b,c),a.clone(b)},a.DepGraph.prototype.addLink=function(a,b,c,d,e){null==d&&(d="black"),null==e&&(e=this.id++),a=a.__data__,b=b.__data__;var f=new Object;return f.source=a.id,f.target=b.id,f["#style"]={"link-color":d},f.label=c,f["#id"]=e,this.insertLink(f),f},a.DepGraph.prototype.addChunk=function(a,b,c,d,e,f){if(!a||!b||0==b.length)throw"Missing required field.";e=e||this.id++,f=f||e,d=d||"transparent";var g={label:a,sublabels:c,elements:b,"#style":{"background-color":d},"#id":e,id:f};return this.insertChunk(g),g},a.DepGraph.prototype.getChunkRange=function(a){for(var b={firstElement:null,lastElement:null},c=this.data.graph.words.length,d=0,e=0;e<a.elements.length;e++){var f=this.getWordByOriginalId(a.elements[e]);f["#position"]<=c&&(b.firstElement=f,c=f["#position"]),f["#position"]>=d&&(b.lastElement=f,d=f["#position"])}return b}}(window.depgraphlib),function(a){a.EditObject.DefaultModeLib={init:null,save:function(a){a.cleanData(),jQuery.ajax({type:"POST",url:a.wsurl,data:{action:"save",format:a.dataFormat,options:"",data:a.data,uid:a.options.uid},dataType:"json",success:function(){a.editObject.lastSavedPtr=a.editObject.currentPtr,a.editObject.needToSaveState=!1,a.editObject.updateSaveState()},error:function(a,b){alert(b)}})},addLinkClick:function(b,c){if(null==b.editObject.previousSelectedObject||a.isALink(b.editObject.previousSelectedObject))a.EditObject.DefaultModeLib.selectObject.call(this,b,c);else if(-1!=b.editObject.keysDown.indexOf(17))a.EditObject.DefaultModeLib.addChunkSettings(b,b.editObject.previousSelectedObject,this,c);else{if(this.__data__["#id"]==b.editObject.previousSelectedObject.__data__["#id"])return b.editObject.clearSelection(),void 0;a.EditObject.DefaultModeLib.addLinkSettings(b,b.editObject.previousSelectedObject,this,c)}},selectObject:function(b){if(b.editObject.highlightMode){var c=!a.isObjectPermanentHighlighted(this);return a.DepGraph.highlightObject(this,c,!0),b.editObject.setNeedToSave(),void 0}b.editObject.selectObject(this)},editKeyDownDefault:function(b,c){if(46==c.keyCode&&null!=b.editObject.previousSelectedObject)if(a.isALink(b.editObject.previousSelectedObject)){var d=a.clone(b.editObject.previousSelectedObject);d.color=a.getStyleElement(b.editObject.previousSelectedObject,"link-color","black");var e=b.removeLink(b.editObject.previousSelectedObject.__data__["#id"]);if(b.editObject.previousSelectedObject=null,e)return{baseAction:"linkRemoval",link:d}}else{if(a.isAWord(b.editObject.previousSelectedObject)){var f=a.clone(b.editObject.previousSelectedObject.__data__),g=b.removeWord(b.editObject.previousSelectedObject.__data__["#id"]);return b.editObject.previousSelectedObject=null,{baseAction:"wordRemoval",word:f,affectedLinks:g}}if(a.isAChunk(b.editObject.previousSelectedObject)){var h=a.clone(b.editObject.previousSelectedObject.__data__),g=b.removeChunk(b.editObject.previousSelectedObject.__data__["#id"]);return b.editObject.previousSelectedObject=null,{baseAction:"chunkRemoval",chunk:h,affectedLinks:g}}}},defaultUndo:function(a,b){if("linkRemoval"==b.baseAction){var c=b.link,d=a.getObjectNodeByOriginalId(c.__data__.source),e=a.getObjectNodeByOriginalId(c.__data__.target);a.addLink(d,e,c.__data__.label,c.color,c.__data__["#id"])}else if("linkAddition"==b.baseAction)a.removeLink(b.addedLink["#id"]);else if("wordAddition"==b.baseAction)a.removeWord(b.addedWord["#id"]);else if("wordRemoval"==b.baseAction){var f=b.word;if(a.addWord(f),null!=b.affectedLinks)for(var g=0;g<b.affectedLinks.length;g++){var c=b.affectedLinks[g],d=a.getObjectNodeByOriginalId(c.source),e=a.getObjectNodeByOriginalId(c.target);c.color=c["#style"]["link-color"]?c["#style"]["link-color"]:a.data.graph["#link-style"]["link-color"],a.addLink(d,e,c.label,c.color,c["#id"])}}else if("changeAttr"==b.baseAction){var h=b.obj["#id"],i=a.getObjectById(h);a.editObject.changeAttributes(i,b.oldAttrs),a.update(),a.postProcesses()}else if("chunkAddition"==b.baseAction)a.removeChunk(b.addedChunk["#id"]);else if("chunkRemoval"==b.baseAction){var j=b.chunk;if(j.color=j["#style"]&&j["#style"]["background-color"]?j["#style"]["background-color"]:a.data.graph["#chunk-style"]["background-color"],a.addChunk(j.label,j.elements,j.sublabels,j.color,j.id,j["#id"]),null!=b.affectedLinks)for(var g=0;g<b.affectedLinks.length;g++){var c=b.affectedLinks[g],d=a.getObjectNodeByOriginalId(c.source),e=a.getObjectNodeByOriginalId(c.target);c.color=c["#style"]&&c["#style"]["link-color"]?c["#style"]["link-color"]:a.data.graph["#link-style"]["link-color"],a.addLink(d,e,c.label,c.color,c["#id"])}}},defaultRedo:function(a,b){if(console.log(b),"linkAddition"==b.baseAction){var c=b.addedLink;a.insertLink(c)}else if("linkRemoval"==b.baseAction)a.removeLink(b.link.__data__["#id"]);else if("wordRemoval"==b.baseAction)a.removeWord(b.word["#id"]);else if("wordAddition"==b.baseAction){var d=b.addedWord;a.addWord(d)}else if("changeAttr"==b.baseAction){var e=b.obj["#id"],f=a.getObjectById(e);a.editObject.changeAttributes(f,b.newAttrs),a.update(),a.postProcesses()}else if("chunkRemoval"==b.baseAction)a.removeChunk(b.chunk["#id"]);else if("chunkAddition"==b.baseAction){var g=b.addedChunk;g.color=g["#style"]&&g["#style"]["background-color"]?g["#style"]["background-color"]:a.data.graph["#chunk-style"]["background-color"],a.addChunk(g.label,g.elements,g.sublabels,g.color,g.id,g["#id"])}},addNewWord:function(b,c){var d=b.viewer.screenCoordsForElt(c[0]),e={x:(d.ne.x+d.nw.x)/2,y:d.nw.y},f=jQuery(a.EditObject.DefaultModeLib.addWordPanel(b));b.viewer.createBox({closeButton:!0,draggable:!0}).setContent(f).open(e)},showEditPanel:function(b,c){var d=b.viewer.screenCoordsForElt(c[0]),e={x:(d.ne.x+d.nw.x)/2,y:d.nw.y},f=a.EditObject.DefaultModeLib.createEditPanel(b,c[0]);b.viewer.createBox({closeButton:!0,draggable:!0}).setContent(f).open(e)},createEditPanel:function(b,c){var d=c.__data__,e="";null!=c.classList&&c.classList.length>0&&(e=c.classList[0]);var f='<div><div id="'+b.viewer.appendOwnID(e+"-save-properties-div")+'" onkeydown="if (event.keyCode == 13) {depgraphlib.EditObject.DefaultModeLib.saveProperties.call(this,arguments);}">'+'<h3 id="edit-info-title">Edit '+e+" (original id: "+d.id+")</h3>"+'<table class="main-properties-table" ref="'+d["#id"]+'">';if("word"==e)f=a.EditObject.DefaultModeLib.populateWordEditPanel(b,f,d);else if("link"==e)f=a.EditObject.DefaultModeLib.populateLinkEditPanel(b,f,d);else{if("chunk"!=e)throw'unknown object type : "'+e+'"';f=a.EditObject.DefaultModeLib.populateChunkEditPanel(b,f,d)}f+="</table>",f+='<input id="'+b.viewer.appendOwnID(e+"-save-properties")+'" type="button" value="Save" onclick="depgraphlib.EditObject.DefaultModeLib.saveProperties.call(this,arguments);">',f+="</div></div>";var g=jQuery(f);return g},populateLinkEditPanel:function(b,c,d){var e=null!=d["#style"]&&null!=d["#style"]["link-color"]?d["#style"]["link-color"]:b.data.graph["#link-style"]["link-color"];return c+=a.ui.addTextField("label",{name:"label",value:d.label,"data-rel":"label"}),c+=a.ui.addCustomField("source",a.EditObject.DefaultModeLib.getOptionsListWords(b,d.source,"source")),c+=a.ui.addCustomField("target",a.EditObject.DefaultModeLib.getOptionsListWords(b,d.target,"target")),c+=a.ui.addCustomField("color",a.ui.simpleColorPicker("colorPicker",e,"#style/link-color"))},populateWordEditPanel:function(b,c,d){var e=b.editObject.dataModel;if(!e.words){e.words=[],e.words[0]={name:"label"};for(var f=0;d.sublabel&&f<d.sublabel.length;f++)e.words[f+1]={name:"sublabel"+f}}c+=a.ui.addTextField(e.words[0].name,{id:"word-edit-"+e.words[0].name,"data-rel":"label",name:e.words[0].name,value:d.label});for(var g=0,f=1;f<e.words.length;f++){var h,i;e.words[f].hidden?(h=d["#data"]?d["#data"][e.words[f].name]:"",i="#data/"+e.words[f].name):(h=d.sublabel[g],i="sublabel/"+g,g++),c+=a.ui.addTextField(e.words[f].name,{id:"word-edit-"+e.words[f].name,"data-rel":i,name:e.words[f].name,value:h})}return c},populateChunkEditPanel:function(b,c,d){var e=b.editObject.dataModel;if(!e.chunks){e.chunks=[],e.chunks[0]={name:"label"};for(var f=0;d.sublabel&&f<d.sublabel.length;f++)e.chunks[f+1]={name:"sublabel"+f}}c+=a.ui.addTextField(e.chunks[0].name,{id:"chunk-edit-"+e.chunks[0].name,"data-rel":"label",name:e.chunks[0].name,value:d.label});var g=b.getChunkRange(d),h=a.ui.addCustomField("first element",a.EditObject.DefaultModeLib.getOptionsListWords(b,g.firstElement.id,"first-element"));h+=a.ui.addCustomField("last element",a.EditObject.DefaultModeLib.getOptionsListWords(b,g.lastElement.id,"last-element")),c+=a.ui.groupFields("Elements Range",{name:"chunkRange","data-rel":"elements"},h);var i=d["#style"]&&d["#style"]["background-color"]?d["#style"]["background-color"]:b.data.graph["#chunk-style"]["background-color"];c+=a.ui.addCustomField("color",a.ui.simpleColorPicker("colorPicker",i,"#style/background-color"));for(var j=0,f=1;f<e.chunks.length;f++){var k,l;e.chunks[f].hidden?(k=wordData["#data"]?d["#data"][e.chunks[f].name]:"",l="#data/"+e.chunks[f].name):(k=d.sublabel[j],l="sublabel/"+j,j++),c+=a.ui.addTextField(e.chunks[f].name,{id:"chunk-edit-"+e.chunks[f].name,"data-rel":l,name:e.chunks[f].name,value:k})}return c},saveProperties:function(){for(var b=a.DepGraph.getInstance(this),c=jQuery(this).parent().find("table.main-properties-table"),d=b.getObjectById(c.attr("ref")),e=c[0].rows,f=[],g=0;g<e.length;g++){var h,i,j=e[g],k=j.cells,l=k[1].firstChild,m=l.nodeName.toUpperCase();if(!l.getAttribute("data-rel"))throw"missing attribute data-rel in edit form";if(i=l.getAttribute("data-rel"),"SELECT"==m)h=l.options[l.options.selectedIndex].value;else if("INPUT"==m)h=l.value;else if("simpleColorPicker"==l.getAttribute("name"))h=l.firstChild.rows[0].cells[0].firstChild.value;else{if("chunkRange"!=l.getAttribute("name"))throw"unknown form element";var n=l.firstChild.rows[0].cells[1].firstChild.options.selectedIndex,o=l.firstChild.rows[0].cells[1].firstChild.options[n].value,p=l.firstChild.rows[1].cells[1].firstChild.options.selectedIndex,q=l.firstChild.rows[1].cells[1].firstChild.options[p].value;h=[o,q]}f.push({path:i,value:h})}b.editObject.changeAttributes(d,f,!0),b.update(),b.postProcesses();var r=a.Box.getBox(this);r.destroy()},addChunkSettings:function(b,c,d,e){var f=b.viewer.screenCoordsForElt(d),g={x:(f.ne.x+f.nw.x)/2,y:f.nw.y},h='<div><table style="margin:5px 0px 0px 0px;">';h+=a.ui.addTextField("Chunk name :",{name:"chunk-name","data-ref":"label"}),h+='<tr><td colspant="2"><input id="chunk-settings'+b.viewer.appendOwnID("")+'"  type="button" style="margin:0" value="Create Chunk"></td></tr>',h+="</table></div>",h=jQuery(h);var i=b.viewer.createBox({closeButton:!0,draggable:!0}).setContent(h).open(g);b.editObject.clearSelection(),jQuery("#chunk-settings"+b.viewer.appendOwnID("")).click(function(){var a=this.parentNode.parentNode.parentNode.childNodes[0].childNodes[1].childNodes[0].value,f=b.addChunk(a,[c.__data__.id,d.__data__.id]);console.log(f);var g={baseAction:"chunkAddition",addedChunk:f};b.editObject.pushAction({mode:b.editObject.editMode,rollbackdata:g,data:{event:"onWordSelect",params:e}}),i.destroy()})},getOptionsListWords:function(a,b,c){for(var d='<select data-rel="'+c+'">',e=0;e<a.data.graph.words.length;e++){var f=a.data.graph.words[e];d+='<option value="'+f.id+'" ',d+=f.id==b?'selected="true"':"",d+=">#"+f["#position"]+" "+f.label+" ("+f.id+")",d+="</option>"}return d+="</select>"},getOptionsPosition:function(a,b){for(var c='<select data-rel="'+b+'">',d=0;d<a.data.graph.words.length+1;d++){var e=d>0&&d<a.data.graph.words.length+1?a.data.graph.words[d-1]:{label:"^"},f=d<a.data.graph.words.length?a.data.graph.words[d]:{label:"$"};c+='<option value="'+d+'" ',c+=">#"+d+" ("+e.label+" x "+f.label+")",c+="</option>"}return c+="</select>"},addWordPanel:function(b){var c="";return c+="<div><h3>Add a new word</h3>",c+="<table><tr>",c+="<td><label>Label</label></td>",c+='<td><input type="text" name="label"></td></tr>',c+="<tr><td><label>Sublabels (separated by commas, use \\, for commas)</label></td>",c+='<td><input type="text" name="sublabels"></td></tr>',c+="<tr><td><label>Position</label></td>",c+="<td>"+a.EditObject.DefaultModeLib.getOptionsPosition(b,"#position")+"</td></tr>",c+="</table></div>"},addLinkSettings:function(a,b,c,d){var e=a.viewer.screenCoordsForElt(c),f={x:(e.ne.x+e.nw.x)/2,y:e.nw.y},g='<div><table style="margin:5px 0px 0px 0px;"><tr><td>Link name : </td><td><input type="text" name="link-name" value=""></td></tr><tr><td>Link color : </td><td><input type="text" name="link-color" value="black"></td></tr><tr><td colspant="2"><input id="link-settings'+a.viewer.appendOwnID("")+'"  type="button" style="margin:0" value="Create Link"></td></tr>'+"</table></div>";g=jQuery(g);var h=a.viewer.createBox({closeButton:!0,draggable:!0}).setContent(g).open(f);a.editObject.clearSelection(),jQuery("#link-settings"+a.viewer.appendOwnID("")).click(function(){var e=this.parentNode.parentNode.parentNode.childNodes[0].childNodes[1].childNodes[0].value,f=this.parentNode.parentNode.parentNode.childNodes[1].childNodes[1].childNodes[0].value,g=a.addLink(b,c,e,f),i={baseAction:"linkAddition",addedLink:g};a.editObject.pushAction({mode:a.editObject.editMode,rollbackdata:i,data:{event:"onWordSelect",params:d}}),h.destroy()})},addWordSettings:function(a,b,c){var d=a.viewer.screenCoordsForElt(b),e={x:(d.ne.x+d.nw.x)/2,y:d.nw.y},f='<div><table style="margin:5px 0px 0px 0px;"><tr><td>Word label : </td><td><input type="text" name="word-label" value=""></td></tr><tr><td colspant="2"><input id="word-settings'+a.viewer.appendOwnID("")+'"  type="button" style="margin:0" value="Insert Word"></td></tr>'+"</table></div>";f=jQuery(f);var g=a.viewer.createBox({closeButton:!0,draggable:!0}).setContent(f).open(e);a.editObject.clearSelection(),jQuery("#word-settings"+a.viewer.appendOwnID("")).click(function(){var d=this.parentNode.parentNode.parentNode.childNodes[0].childNodes[1].childNodes[0].value;if(null==d||""==d)return alert("you must fill all required fields"),void 0;var e={label:d,sublabel:[],"#position":b.__data__["#position"]+c},f=a.addWord(e),h={baseAction:"wordAddition",addedWord:f};a.editObject.pushAction({mode:a.editObject.editMode,rollbackdata:h,data:{event:"onWordContext",params:b}}),g.destroy()})}}}(window.depgraphlib),function(a){a.EditObject.DefaultMode={name:"default",onInit:null,onWordSelect:a.EditObject.DefaultModeLib.addLinkClick,onLinkSelect:a.EditObject.DefaultModeLib.selectObject,onChunkSelect:a.EditObject.DefaultModeLib.addLinkClick,onGlobalContext:null,onWordContext:{"Show Infos":function(b,c){a.EditObject.DefaultModeLib.showEditPanel(b,c)},"Add Node to the left":function(b,c){a.EditObject.DefaultModeLib.addWordSettings(b,c[0],0)},"Add Node to the right":function(b,c){a.EditObject.DefaultModeLib.addWordSettings(b,c[0],1)},Delete:function(b,c){var d=a.clone(c[0].__data__),e=b.removeWord(c[0].__data__["#id"]);return b.editObject.previousSelectedObject=null,{baseAction:"wordRemoval",word:d,affectedLinks:e}
}},onLinkContext:{"Show Infos":function(b,c){a.EditObject.DefaultModeLib.showEditPanel(b,c)},Delete:function(b,c){var d=a.clone(c[0]);d.color=a.getStyleElement(c[0],"link-color","black");var e=b.removeLink(c[0].__data__["#id"]);return b.editObject.previousSelectedObject=null,e?{baseAction:"linkRemoval",link:d}:void 0}},onChunkContext:{"Show Infos":function(b,c){a.EditObject.DefaultModeLib.showEditPanel(b,c)},Delete:function(b,c){var d=a.clone(c[0].__data__),e=b.removeChunk(c[0].__data__["#id"]);return b.editObject.previousSelectedObject=null,{baseAction:"chunkRemoval",chunk:d,affectedLinks:e}}},onKeyDown:a.EditObject.DefaultModeLib.editKeyDownDefault,onKeyPress:null,onKeyUp:null,save:null,undo:a.EditObject.DefaultModeLib.defaultUndo,redo:a.EditObject.DefaultModeLib.defaultRedo}}(window.depgraphlib),function(a){a.EditObject.prototype.init=function(b){this.depgraph=b,this.editMode=!1,this.mode=[],this.highlightMode=!1,this.dataModel={},this.previousSelectedObject=null,this.actionsLog=[],this.currentPtr=-1,this.lastSavedPtr=-1,this.keysDown=[],this.addEditMode(a.EditObject.DefaultMode)},a.EditObject.prototype.setDataModel=function(a){this.dataModel=a},a.EditObject.prototype.dataChanged=function(){return this.needToSaveState?!0:0==this.actionsLog.length?!1:this.currentPtr!=this.lastSavedPtr?!0:!1},a.EditObject.prototype.addEditMode=function(a){this.mode[a.name]=a},a.EditObject.prototype.setEditMode=function(a){var b=this;if(null==a)a="default";else{editModeExist=!1;for(i in this.mode)if(this.mode[i].name==a){editModeExist=!0;break}editModeExist||(alert("this edition mode does not exist! switching to default mode"),a="default")}this.editMode=a,this.needToSaveState=!1,window.onbeforeunload=a?function(a){if(b.dataChanged()){var c="Changes made to the graph are not saved. If you leave this page all modifications will be lost.";return a=a||window.event,a&&(a.returnValue=c),c}}:null,this.editModeInit(),this.initToolbar()},a.EditObject.prototype.initToolbar=function(){function b(){var a=h.editObject;a.highlightMode=!a.highlightMode,a.highlightMode?(a.clearSelection(),h.viewer.setToolbarItemState("highlight",!0)):h.viewer.setToolbarItemState("highlight",!1)}function c(){var a=h.editObject;null!=a.mode[a.editMode].save&&a.mode[a.editMode].save(h)}function d(){var a=h.editObject;0==h.editObject.currentPtr&&h.viewer.setToolbarItemActive("undo",!1);var b=h.editObject.actionsLog[h.editObject.currentPtr];null!=a.mode[b.mode].undo&&a.mode[b.mode].undo.call(a,h,b.rollbackdata),h.editObject.currentPtr--,null!=a.mode[b.mode].redo&&h.viewer.setToolbarItemActive("redo",!0),a.updateSaveState()}function e(){var a=h.editObject;h.editObject.currentPtr++,h.editObject.currentPtr==h.editObject.actionsLog.length-1&&h.viewer.setToolbarItemActive("redo",!1);var b=h.editObject.actionsLog[h.editObject.currentPtr];null!=a.mode[b.mode].redo&&a.mode[b.mode].redo.call(a,h,b.rollbackdata),h.viewer.setToolbarItemActive("undo",!0),a.updateSaveState()}function f(){var b=this.getBoundingClientRect(),c={x:b.left,y:b.top+b.height+2},d="<div>";d+='Export Format : <select name="type"><option value="png">png</option><option value="json" selected>json</option><option value="depxml">depxml</option><option value="dep2pict">dep2pict</option><option value="conll">conll</option></select><br/><input id="export-data'+h.viewer.appendOwnID("")+'"  type="button" value="Export"></div>',d=jQuery(d);var e=h.viewer.createBox({closeButton:!0,autodestroy:!0});e.setContent(jQuery(d)),jQuery("#export-data"+h.viewer.appendOwnID("")).click(function(){var b=jQuery("select",this.parentNode),c=b[0].options[b[0].selectedIndex].value;"png"==c?g():(h.cleanData(),a.windowOpenPost({action:"export",data:h.data,source_format:"json",target_format:c},h.wsurl)),e.destroy()}),e.open(c)}function g(){d3.select("rect.export_bg").attr("width","100%").attr("height","100%");var b=h.svg.node().getBBox();h.svg.attr("width",b.width),h.svg.attr("height",b.height);var c=(new XMLSerializer).serializeToString(h.svg.node());a.windowOpenPost({action:"export",data:c,source_format:"json",target_format:"png"},h.wsurl),d3.select("rect.export_bg").attr("width","0").attr("height","0")}var h=this.depgraph;h.viewer.resetToolbarItems();var i=[{name:"undo",callback:d,style:"undo",group:"control"},{name:"redo",callback:e,style:"redo",group:"control"},{name:"highlight",callback:b,style:"highlightoff"},{name:"export",callback:f,style:"export",group:"0"},{name:"save",callback:c,style:"saved",group:"0"}];if(null!=this.mode[this.editMode].buttons)for(button in this.mode[this.editMode].buttons)i.push(button);h.viewer.addToolbarItems(i),(this.currentPtr<0||null==this.mode[this.editMode].undo)&&h.viewer.setToolbarItemActive("undo",!1),(this.currentPtr==this.actionsLog.length-1||null==this.mode[this.editMode].redo)&&h.viewer.setToolbarItemActive("redo",!1)},a.EditObject.prototype.setNeedToSave=function(){this.needToSaveState=!0,this.updateSaveState()},a.EditObject.prototype.updateSaveState=function(){this.lastSavedPtr!=this.currentPtr||this.needToSaveState?this.depgraph.viewer.getToolbarItem("save").button.removeClass("saved").addClass("save"):this.depgraph.viewer.getToolbarItem("save").button.removeClass("save").addClass("saved")},a.EditObject.prototype.editModeInit=function(){function a(a,b,c){var d=h.editObject,b=b.menu;if(null!=d.mode[d.editMode][a][b]){var e=d.mode[d.editMode][a][b].call(this,h,c);d.pushAction({mode:d.editMode,rollbackdata:e,data:{event:"onContextClick",params:{object_type:a,menu:b,object:c}}})}}function b(a,b){var c=h.editObject;if(null!=c.mode[c.editMode].onWordSelect){var d=c.mode[c.editMode].onWordSelect.call(this,h,{d:a,i:b});c.pushAction({mode:c.editMode,rollbackdata:d,data:{event:"onWordSelect",params:{d:a,i:b}}})}}function c(a,b){var c=h.editObject;if(null!=c.mode[c.editMode].onLinkSelect){var d=c.mode[c.editMode].onLinkSelect.call(this,h,{d:a,i:b});c.pushAction({mode:c.editMode,rollbackdata:d,data:{event:"onLinkSelect",params:{d:a,i:b}}})}}function d(a,b){var c=h.editObject;if(null!=c.mode[c.editMode].onChunkSelect){var d=c.mode[c.editMode].onChunkSelect.call(this,h,{d:a,i:b});c.pushAction({mode:c.editMode,rollbackdata:d,data:{event:"onChunkSelect",params:{d:a,i:b}}})}}function e(){var a=h.editObject;if(a.keysDown.push(d3.event.keyCode),null!=a.mode[a.editMode].onKeyDown){var b=a.mode[a.editMode].onKeyDown.call(this,h,{keyCode:d3.event.keyCode});a.pushAction({mode:a.editMode,rollbackdata:b,data:{event:"onKeyDown",params:{keyCode:d3.event.keyCode}}})}}function f(){var a=h.editObject;if(null!=a.mode[a.editMode].onKeyPress){var b=a.mode[a.editMode].onKeyPress.call(this,h,{keyCode:d3.event.keyCode});a.pushAction({mode:a.editMode,rollbackdata:b,data:{event:"onKeyPress",params:{keyCode:d3.event.keyCode}}})}}function g(){var a=h.editObject,b=a.keysDown.indexOf(d3.event.keyCode);if(-1!=b&&a.keysDown.splice(b,1),null!=a.mode[a.editMode].onKeyUp){var c=a.mode[a.editMode].onKeyUp.call(this,h,{keyCode:d3.event.keyCode});a.pushAction({mode:a.editMode,rollbackdata:c,data:{event:"onKeyUp",params:{keyCode:d3.event.keyCode}}})}}var h=this.depgraph;if(this.mode[this.editMode].onInit&&this.mode[this.editMode].onInit.call(this,h),!this.editMode)return this.depgraph.vis.selectAll("g.word").on("click",null),this.depgraph.vis.selectAll("g.link").on("click",null),this.depgraph.vis.selectAll("g.chunk").on("click",null),d3.select(document).on("keydown.edit"+this.depgraph.viewer.uid,null),this.depgraph.viewer.resetToolbarItems(),jQuery(".link",this.depgraph.vis.node()).contextMenu("",{}),jQuery(".word",this.depgraph.vis.node()).contextMenu("",{}),jQuery(".chunk",this.depgraph.vis.node()).contextMenu("",{}),void 0;if(this.depgraph.vis.selectAll("g.word").on("click",b),this.depgraph.vis.selectAll("g.link").on("click",c),this.depgraph.vis.selectAll("g.chunk").on("click",d),d3.select(document).on("keydown.edit"+this.depgraph.viewer.uid,e),d3.select(document).on("keypress.edit"+this.depgraph.viewer.uid,f),d3.select(document).on("keyup.edit"+this.depgraph.viewer.uid,g),null!=this.mode[this.editMode].onLinkContext){var i={};for(menu in this.mode[this.editMode].onLinkContext)i[menu]={menu:menu,click:function(b){a("onLinkContext",this,b)},klass:"menu-item-1"};jQuery(".link",this.depgraph.vis.node()).contextMenu("link-context-menu",i)}if(null!=this.mode[this.editMode].onWordContext){var i={};for(menu in this.mode[this.editMode].onWordContext)i[menu]={menu:menu,click:function(b){a("onWordContext",this,b)},klass:"menu-item-1"};jQuery(".word",this.depgraph.vis.node()).contextMenu("word-context-menu",i)}if(null!=this.mode[this.editMode].onChunkContext){var i={};for(menu in this.mode[this.editMode].onChunkContext)i[menu]={menu:menu,click:function(b){a("onChunkContext",this,b)},klass:"menu-item-1"};jQuery(".chunk",this.depgraph.vis.node()).contextMenu("chunk-context-menu",i)}if(null!=this.mode[this.editMode].onGlobalContext){var i={};for(menu in this.mode[this.editMode].onGlobalContext)i[menu]={menu:menu,click:function(b){a("onGlobalContext",this,b)},klass:"menu-item-1"};jQuery(this.depgraph.svg.node()).contextMenu("main-menu",i)}},a.EditObject.prototype.pushAction=function(a){null!=a.rollbackdata&&null!=this.mode[a.mode].undo&&(this.depgraph.viewer.setToolbarItemActive("redo",!1),this.depgraph.viewer.setToolbarItemActive("undo",!0),this.actionsLog.splice(++this.currentPtr,this.actionsLog.length-this.currentPtr,a),this.updateSaveState())},a.EditObject.prototype.clearSelection=function(){if(null!=this.previousSelectedObject){try{this.previousSelectedObject.selected=!1,a.DepGraph.highlightObject(this.previousSelectedObject,!1)}catch(b){}this.previousSelectedObject=null}},a.EditObject.prototype.selectObject=function(b){return this.previousSelectedObject==b?(this.clearSelection(),void 0):(this.clearSelection(),this.previousSelectedObject=b,a.DepGraph.highlightObject(this.previousSelectedObject,!0),b.selected=!0,void 0)},a.EditObject.prototype.changeAttributes=function(b,c,d){for(var e=a.clone(b),f=[],g=0;g<c.length;g++){var h=a.setAttrPath(b,c[g].path,c[g].value);f.push({path:c[g].path,value:h})}if(null!=d&&d){var i={mode:this.editMode,rollbackdata:{baseAction:"changeAttr",obj:e,attrs:c,oldAttrs:f,newAttrs:c}};this.pushAction(i)}},a.EditObject.prototype.addEditModeSwitcher=function(){var b=this;this.depgraph.viewer.addToolbarItem({name:"customeditmode",tooltip:"Custom Edit Mode",callback:function(){var c=confirm("You will not be able to get back to frmg edit mode, are you sure you want to edit manually the graph?");1==c&&(a.hideAltLinks(b.depgraph,b.depgraph.editObject.previousSelectedObject),b.setEditMode("default"))},style:"default-edit"})}}(window.depgraphlib),function(a){a.FRMGEditMode=function(b){function c(a){var b=h(a),c=a.editObject.mode[a.editObject.editMode].highlightInfos;jQuery.ajax({type:"POST",url:a.wsurl,data:{action:"save",format:"frmgserver",options:b,highlighting:c,data:a.sentence,uid:a.options.uid},dataType:"json",success:function(){a.editObject.lastSavedPtr=a.editObject.currentPtr,a.editObject.needToSaveState=!1,a.editObject.updateSaveState()},error:function(a,b){alert(b)}})}function d(b){if(null==b.editObject.previousSelectedObject||a.isALink(b.editObject.previousSelectedObject)||o(b,b.editObject.previousSelectedObject),!j(b,this)){if(this==b.editObject.previousSelectedObject)return b.editObject.clearSelection(),void 0;b.editObject.selectObject(this),m(b,this)}}function e(a,b){if("removeEdge"==b.baseAction||"selectAlternative"==b.baseAction){var c=b.previousParams;""==c&&(c=a.original_data.graph.params),l(a,a.sentence,c)}}function f(b,c){if(46==c.keyCode&&null!=b.editObject.previousSelectedObject&&a.isALink(b.editObject.previousSelectedObject)){var c=k(b,b.sentence,b.editObject.previousSelectedObject.__data__);return{baseAction:"removeEdge",previousParams:h(b),currentParams:c}}}function g(b,c){if(null==b.editObject.previousSelectedObject||a.isALink(b.editObject.previousSelectedObject)||o(b,b.editObject.previousSelectedObject),!j(b,this)&&a.isALink(this)&&1==this.__data__["#data"].virtual){var c="";for(id in this.__data__.ref_ids)return c+="eid="+this.__data__.ref_ids[id]+"&+99999",l(b,b.sentence,c),{baseAction:"selectAlternative",previousParams:h(b),currentParams:c}}}function h(a){var b=a.editObject;if(-1==b.currentPtr)return"";var c=b.actionsLog[b.currentPtr];return c.rollbackdata.currentParams}function j(b,c){if(b.editObject.highlightMode){b.editObject.clearSelection();var d=!a.isObjectPermanentHighlighted(c);a.DepGraph.highlightObject(c,d,!0),null==b.editObject.mode[b.editObject.editMode].highlightInfos&&(b.editObject.mode[b.editObject.editMode].highlightInfos=b.data.graph.highlighting?b.data.graph.highlighting:[]);var e=b.editObject.mode[b.editObject.editMode].highlightInfos,f=e.indexOf(c.__data__.id);return-1==f||d?-1==f&&d&&e.push(c.__data__.id):e.splice(f,1),b.editObject.setNeedToSave(),!0}return!1}function k(a,b,c){var d=a.getWordByOriginalId(c.source),e=a.getWordByOriginalId(c.target),f=d.__data__["#data"],g=e.__data__["#data"],h="edge="+f.lemma+"&"+f.cat+"&"+c.label+"&"+g.lemma+"&"+g.cat+"&-8000";return l(a,b,h),h}function l(a,c,d){a.viewer.ajaxStart(),jQuery.ajax({type:"GET",url:b,data:{sentence:c,options:d,schema:"dep",view:"txt"},dataType:"json",success:function(b){a.resetData(b),a.viewer.ajaxFinished()},error:function(b,c){alert(c),a.viewer.ajaxFinished()}})}function m(a,b){for(link in b.__data__["#data"].alternatives)a.data.graph.links.push(b.__data__["#data"].alternatives[link]);a.update(),a.postProcesses(),a.editObject.editModeInit(),a.autoHighLightOnMouseOver(),n(a,b.__data__["#data"].alternatives)}function n(a,b){null==b&&(b=[]),a.vis.selectAll("g.link").each(function(a,c){for(c in b)if(b[c]["#id"]==a["#id"])return this.components.path.attr("stroke-dasharray","5,5"),void 0;this.components.path.attr("stroke","grey")})}function o(a,b){if(b){for(i in b.__data__["#data"].alternatives){var c=b.__data__["#data"].alternatives[i],d=a.getLinkIndexByOriginalId(c.id);if(null==d)return!1;a.data.graph.links.splice(d,1)}a.update(),a.postProcesses()}}this.mode={name:"frmg",onWordSelect:d,onLinkSelect:g,onChunkSelect:a.selectObject,onWordContext:{"Show Infos":function(b,c){a.showEditPanel(b,c)},HighLight:function(a,b){j(a,b)}},onLinkContext:{"Show Infos":function(b,c){a.showEditPanel(b,c)},HighLight:function(a,b){j(a,b)}},onChunkContext:null,keyHandler:f,undo:e,save:c,highlightInfos:null},a.getPreviousParams=h,a.getNewData=l,a.hideAltLinks=o}}(window.depgraphlib),function(a){function b(a){return-1!==a.indexOf("</a>",a.length-4)?a:a+"</a>"}a.default_save=function(a){a.cleanData(),jQuery.ajax({type:"POST",url:"edit/save",data:{format:a.dataFormat,options:"",data:a.data},dataType:"json",success:function(){a.editObject.lastSavedPtr=a.editObject.currentPtr,a.editObject.needToSaveState=!1,a.editObject.updateSaveState()},error:function(a,b){alert(b)}})},a.showRefs=function(){var c=a.DepGraph.getInstance(this),d=this.getBoundingClientRect(),e={x:d.left,y:d.top+d.height+2},f="<div>Reference Infos : <br>";f+="Sentence : "+b(c.sentenceLink)+"<br>"+"Back Links : "+c.refs+"</div>",f=jQuery(f),c.viewer.createBox({closeButton:!0,position:e,autodestroy:!0,forceToolbar:!0}).setContent(f).open()},a.mgwiki_d3js_module_action=function(a,b,c){jQuery.ajax({type:"POST",url:c,data:{gid:b,action:"promote"},dataType:a,success:function(a){a.success?window.location="":alert(a.error)},error:function(a,b){alert(b)}})},a.promote=function(b,c){a.mgwiki_d3js_module_action("promote",b,c)},a.reload=function(b,c){a.mgwiki_d3js_module_action("reload",b,c)},a.remove=function(b,c){a.mgwiki_d3js_module_action("remove",b,c)}}(window.depgraphlib);